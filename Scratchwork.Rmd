---
title: "Scratchwork"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#READING IN DATA
library(lubridate)
library(sf)
library(dplyr)
library(reshape2)
gdb <- "/Users/salmahuque/Desktop/BigThesis/Reed/data.gdb"
layers <- st_layers(gdb)
layers


school_zones <- st_read(gdb, layer = "school_attendance_areas")
bli_devo_cap <- st_read(gdb, layer = "bli_development_capacity")
cop_sales_history <- st_read(gdb, layer = "CoP_OrionSalesHistory")
cop_improve_segment <- st_read(gdb, layer = "CoP_OrionImprovementSegment")
cop_gis_property <- st_read(gdb, layer = "CoP_GISProperty")
cop_gis_improvement <- st_read(gdb, layer = "CoP_GISImprovement")
cop_all_props <- st_read(gdb, layer = "CoP_AllProperties")
roll_values <- st_read(gdb, layer = "roll_values")
roll_history_wide <- st_read(gdb, layer = "roll_history_wide")
roll_history <- st_read(gdb, layer = "roll_history")
imp_segments <- st_read(gdb, layer = "imp_segments")
seg_char <- st_read(gdb, layer = "Seg_Char")
plumbing_lu <- st_read(gdb, layer = "Plumbing_Lookup")
fireplace_lu <- st_read(gdb, layer = "Fireplace_Lookup")
imp_type_lu <  st_read(gdb, layer = "Imp_Type_Lookup")
imp_codes_lu <- st_read(gdb, layer = "Improvement_Codes_Lookup")
seg_type_lu <- st_read(gdb, layer = "Segment_Type_Lookup")
prop_code_lu <- st_read(gdb, layer = "Property_Code_Lookup")
improvements <- st_read(gdb, layer = "improvements")
```

```{r}

bigid <- c("R122577", "R290070")
littleid <- c("79992", "241919")
stid <- "1S2E17CD  19900"
rno <- c("R110500190", "R842406870")
  filter(bli_devo_cap, RNO == rno)
  filter(cop_all_props, PropertyID == littleid)
  filter(cop_gis_improvement, PropID == bigid)
  filter(cop_gis_property, PropID == bigid)
  filter(cop_improve_segment, PropID == bigid)
  filter(cop_sales_history, PropID == bigid)
  filter(imp_segments, PropertyID == bigid)
  filter(improvements, PropertyID == bigid)
  filter(roll_history, PropertyID == bigid)
  filter(roll_history_wide, PropertyID == bigid)
  filter(roll_values, PropertyID == bigid)
  filter(seg_char, PropertyID == bigid)

test <- bind_cols(
  bli_obs <- filter(bli_devo_cap, RNO %in% rno),
  allprop_obs <- filter(cop_all_props, PropertyID %in% littleid),
  gisimp_obs <- filter(cop_gis_improvement, PropID %in% bigid),
  gisprop_obs <- filter(cop_gis_property, PropID %in% bigid),
  copimpseg_obs <- filter(cop_improve_segment, PropID %in% bigid),
  saleshist_obs <- filter(cop_sales_history, PropID %in% bigid),
  impseg_obs <- filter(imp_segments, PropertyID %in% bigid),
  imps_obs <- filter(improvements, PropertyID %in% bigid),
  rollhist_obs <- filter(roll_history, PropertyID %in% bigid),
  rollhistwide_obs <- filter(roll_history_wide, PropertyID %in% bigid),
  rollvals_obs <- filter(roll_values, PropertyID %in% bigid),
  segchar_obs <- filter(seg_char, PropertyID %in% bigid)
  )

test <- bind_cols(
  allprop_obs <- filter(cop_all_props, PropertyID %in% littleid),
  gisimp_obs <- filter(cop_gis_improvement, PropID %in% bigid),
  gisprop_obs <- filter(cop_gis_property, PropID %in% bigid),
  imps_obs <- filter(improvements, PropertyID %in% bigid),
  rollhistwide_obs <- filter(roll_history_wide, PropertyID %in% bigid)
  )


leftover: 
  bli_obs == 0 #because contraints not available
  impseg_obs == 9
  copimpseg_obs == 9
  saleshist_obs == 7
  rollhist_obs == 44
  rollvals_obs == 44
  segchar_obs == 0
  
#reshaping obs
copimpseg_reshape <- dcast(copimpseg_obs, PropID + TaxYear ~ SegmentType, value.var = "SegmentSqFt") 
impseg_reshape <- dcast(impseg_obs, PropertyID ~ Seg_Type) 
rollhist_reshape <- dcast(rollhist_obs, PropertyID ~ year)
rollvals_reshape <- dcast(rollvals_obs, PropertyID ~ year)
  
selectanobs <- function(letter_id, number_id, state_id, rno) {
  (filter(bli_devo_cap, RNO == rno)
  filter(cop_all_props, PropertyID == number_id)
  filter(cop_gis_improvement, PropID == letter_id)
  filter(cop_gis_improvement, PropID == letter_id)
  filter(cop_improve_segment, PropID == letter_id)
  filter(cop_sales_history, PropID == letter_id)
  filter(imp_segments, PropertyID == letter_id)
  filter(improvements, PropertyID == letter_id)
  filter(roll_history, PropertyID == letter_id)
  filter(roll_history_wide, PropertyID == letter_id)
  filter(roll_values, PropertyID == letter_id)
  filter(seg_char, PropertyID == letter_id)

  
}
```

